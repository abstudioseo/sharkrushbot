<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Panel V3 - MoneyShark</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a1929;
            --bg-card: rgba(17, 34, 64, 0.8);
            --bg-input: rgba(0, 0, 0, 0.3);
            --primary: #00d9ff;
            --primary-glow: rgba(0, 217, 255, 0.3);
            --gold: #fbbf24;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --text: #e2e8f0;
            --text-muted: #94a3b8;
            --border: rgba(0, 217, 255, 0.2);
            --border-hover: rgba(0, 217, 255, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #051525 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 3px; }

        /* Login Screen */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background: radial-gradient(circle at 50% 50%, rgba(0, 217, 255, 0.1) 0%, transparent 50%);
        }

        .login-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 48px 40px;
            max-width: 420px;
            width: 100%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 80px var(--primary-glow);
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), #0099cc);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 50px;
            box-shadow: 0 0 50px var(--primary-glow);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 30px var(--primary-glow); transform: scale(1); }
            50% { box-shadow: 0 0 60px var(--primary-glow); transform: scale(1.02); }
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--text);
            font-size: 13px;
            font-weight: 500;
        }

        input, textarea, select {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-glow);
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-muted);
        }

        .btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary), #0099cc);
            border: none;
            border-radius: 12px;
            color: #000;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px var(--primary-glow);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #16a34a);
            color: #fff;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: #fff;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #d97706);
            color: #000;
        }

        .btn-small {
            padding: 10px 16px;
            font-size: 13px;
            width: auto;
        }

        .btn-icon {
            padding: 10px;
            width: 40px;
            height: 40px;
            border-radius: 10px;
        }

        .hidden { display: none !important; }

        /* Dashboard */
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px 24px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), #0099cc);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .header-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
        }

        .header-subtitle {
            font-size: 13px;
            color: var(--text-muted);
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .stat-icon.gold { background: rgba(251, 191, 36, 0.2); }
        .stat-icon.users { background: rgba(0, 217, 255, 0.2); }
        .stat-icon.tasks { background: rgba(34, 197, 94, 0.2); }
        .stat-icon.withdrawals { background: rgba(239, 68, 68, 0.2); }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--text);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Tabs */
        .tabs-container {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 8px;
            margin-bottom: 24px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tabs {
            display: flex;
            gap: 4px;
            min-width: max-content;
        }

        .tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            background: rgba(0, 217, 255, 0.1);
            color: var(--text);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary), #0099cc);
            color: #000;
            font-weight: 600;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--border-hover);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }

        .card-subtitle {
            color: var(--text-muted);
            font-size: 13px;
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        /* Items List */
        .items-grid {
            display: grid;
            gap: 12px;
        }

        .item {
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .item:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 16px;
            margin-bottom: 12px;
        }

        .item-title {
            font-weight: 600;
            font-size: 15px;
            color: var(--text);
        }

        .item-desc {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .item-meta {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 8px;
        }

        .item-reward {
            font-size: 14px;
            font-weight: 600;
            color: var(--gold);
            margin-top: 8px;
        }

        /* Badges */
        .badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-pending {
            background: rgba(251, 191, 36, 0.2);
            color: var(--gold);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .badge-approved {
            background: rgba(34, 197, 94, 0.2);
            color: var(--success);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .badge-rejected {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .badge-active {
            background: rgba(0, 217, 255, 0.2);
            color: var(--primary);
            border: 1px solid rgba(0, 217, 255, 0.3);
        }

        /* Button Groups */
        .btn-group {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        /* Help Text */
        .help-text {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            padding: 16px 20px;
            border-radius: 12px;
            min-width: 280px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast-success {
            background: rgba(34, 197, 94, 0.9);
            border: 1px solid rgba(34, 197, 94, 0.5);
            color: #fff;
        }

        .toast-error {
            background: rgba(239, 68, 68, 0.9);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #fff;
        }

        .toast-info {
            background: rgba(0, 217, 255, 0.9);
            border: 1px solid rgba(0, 217, 255, 0.5);
            color: #000;
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
            margin: 40px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            text-align: center;
            color: var(--text-muted);
            font-size: 14px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 32px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary);
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--danger);
            border-color: var(--danger);
        }

        /* Tags */
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: rgba(0, 217, 255, 0.1);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 12px;
            color: var(--text);
        }

        .tag-remove {
            cursor: pointer;
            color: var(--danger);
            font-weight: bold;
        }

        /* Table */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th, td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-input);
            font-weight: 600;
            color: var(--text-muted);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: rgba(0, 217, 255, 0.05);
        }

        /* Search */
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            padding-left: 44px;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard {
                padding: 12px;
            }

            .header {
                flex-direction: column;
                text-align: center;
            }

            .header-left {
                flex-direction: column;
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn-group .btn {
                width: 100%;
            }

            .card {
                padding: 16px;
            }

            .login-card {
                padding: 32px 24px;
            }
        }

        /* Section Title */
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Divider */
        .divider {
            height: 1px;
            background: var(--border);
            margin: 24px 0;
        }

        /* Switch */
        .switch-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .switch {
            position: relative;
            width: 48px;
            height: 26px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .switch-slider {
            position: absolute;
            inset: 0;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .switch-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background: var(--text-muted);
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .switch input:checked + .switch-slider {
            background: var(--primary);
            border-color: var(--primary);
        }

        .switch input:checked + .switch-slider:before {
            transform: translateX(22px);
            background: #fff;
        }

        /* Prize inputs */
        .prize-inputs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        @media (max-width: 480px) {
            .prize-inputs {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="logo">ü¶à</div>
                <h1>Admin Panel V3</h1>
                <p class="subtitle">MoneyShark Management System</p>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label>üìß Email Address</label>
                    <input type="email" id="loginEmail" placeholder="admin@example.com" required>
                </div>
                <div class="form-group">
                    <label>üîí Password</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="submit" class="btn" id="loginBtn">
                    <span>üöÄ</span> Login to Dashboard
                </button>
            </form>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="hidden">
        <div class="dashboard">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <div class="header-icon">ü¶à</div>
                    <div>
                        <div class="header-title">MoneyShark Admin</div>
                        <div class="header-subtitle">Control Panel V3</div>
                    </div>
                </div>
                <button class="btn btn-secondary btn-small" onclick="logout()">
                    üö™ Logout
                </button>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-card">
                    <div class="stat-icon users">üë•</div>
                    <div>
                        <div class="stat-value" id="statUsers">0</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon gold">üí∞</div>
                    <div>
                        <div class="stat-value" id="statGold">0</div>
                        <div class="stat-label">Total Gold</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon tasks">üìã</div>
                    <div>
                        <div class="stat-value" id="statTasks">0</div>
                        <div class="stat-label">Active Tasks</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon withdrawals">üí∏</div>
                    <div>
                        <div class="stat-value" id="statWithdrawals">0</div>
                        <div class="stat-label">Pending Withdrawals</div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('withdrawals')">üí∏ Withdrawals</button>
                    <button class="tab" onclick="switchTab('tasks')">üìã Tasks</button>
                    <button class="tab" onclick="switchTab('users')">üë• Users</button>
                    <button class="tab" onclick="switchTab('giveaways')">üéÅ Giveaways</button>
                    <button class="tab" onclick="switchTab('quests')">üéØ Quests</button>
                    <button class="tab" onclick="switchTab('luckycodes')">üçÄ Lucky Codes</button>
                    <button class="tab" onclick="switchTab('gifts')">üéÅ Treasure</button>
                    <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è Settings</button>
                    <button class="tab" onclick="switchTab('bot')">ü§ñ Bot Config</button>
                    <button class="tab" onclick="switchTab('admins')">üëë Admins</button>
                </div>
            </div>

            <!-- Withdrawals Tab -->
            <div id="withdrawals" class="tab-content active">
                <div class="card">
                    <div class="card-header">
                        <span>üí∏</span>
                        <span class="card-title">Withdrawal Requests</span>
                    </div>
                    <p class="card-subtitle">Manage pending and processed withdrawal requests</p>
                    
                    <div class="search-box">
                        <span class="search-icon">üîç</span>
                        <input type="text" id="searchWithdrawals" placeholder="Search by username or wallet..." oninput="filterWithdrawals()">
                    </div>
                    
                    <div id="withdrawalsList" class="items-grid">
                        <div class="spinner"></div>
                        <p class="loading-text">Loading withdrawals...</p>
                    </div>
                </div>
            </div>

            <!-- Tasks Tab -->
            <div id="tasks" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>‚ûï</span>
                        <span class="card-title">Create New Task</span>
                    </div>
                    <p class="card-subtitle">Add a new task for users to complete</p>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Task Title</label>
                            <input type="text" id="taskTitle" placeholder="Join our Telegram">
                        </div>
                        <div class="form-group">
                            <label>Task Type</label>
                            <select id="taskType" onchange="toggleTaskFields()">
                                <option value="link">Direct Link</option>
                                <option value="telegram">Telegram Channel</option>
                                <option value="code">Code Verification</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="taskDesc" rows="2" placeholder="Complete this task to earn rewards"></textarea>
                    </div>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Task Link</label>
                            <input type="url" id="taskLink" placeholder="https://t.me/channel">
                        </div>
                        <div class="form-group">
                            <label>Reward (GOLD)</label>
                            <input type="number" id="taskReward" value="100" placeholder="100">
                        </div>
                    </div>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Max Impressions (0 = unlimited)</label>
                            <input type="number" id="taskImpressions" value="0" placeholder="0">
                            <p class="help-text">Task hides when limit reached</p>
                        </div>
                        <div class="form-group" id="taskCodeGroup" style="display: none;">
                            <label>Required Code</label>
                            <input type="text" id="taskCode" placeholder="SECRET123">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="createTask()">
                        ‚ûï Create Task
                    </button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span>üìã</span>
                        <span class="card-title">Existing Tasks</span>
                    </div>
                    <div id="tasksList" class="items-grid">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Users Tab -->
            <div id="users" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>üë•</span>
                        <span class="card-title">User Management</span>
                    </div>
                    <p class="card-subtitle">Search and manage users</p>
                    
                    <div class="search-box">
                        <span class="search-icon">üîç</span>
                        <input type="text" id="searchUsers" placeholder="Search by username or ID..." oninput="filterUsers()">
                    </div>
                    
                    <div id="usersList" class="items-grid">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Giveaways Tab -->
            <div id="giveaways" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>üéÅ</span>
                        <span class="card-title">Create Giveaway</span>
                    </div>
                    <p class="card-subtitle">Create a new giveaway with prizes</p>
                    
                    <div class="form-group">
                        <label>Giveaway Title</label>
                        <input type="text" id="giveawayTitle" placeholder="Weekly Gold Giveaway">
                    </div>
                    
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="giveawayDesc" rows="2" placeholder="Complete tasks to earn cards and win!"></textarea>
                    </div>
                    
                    <div class="section-title">üèÜ Prize Amounts (GOLD)</div>
                    <div class="prize-inputs">
                        <div class="form-group">
                            <label>ü•á 1st Prize</label>
                            <input type="number" id="prize1" value="10000" placeholder="10000">
                        </div>
                        <div class="form-group">
                            <label>ü•à 2nd Prize</label>
                            <input type="number" id="prize2" value="5000" placeholder="5000">
                        </div>
                        <div class="form-group">
                            <label>ü•â 3rd Prize</label>
                            <input type="number" id="prize3" value="2500" placeholder="2500">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Duration (Days)</label>
                        <input type="number" id="giveawayDays" value="7" placeholder="7">
                        <p class="help-text">Giveaway will end after this many days</p>
                    </div>
                    
                    <button class="btn" onclick="createGiveaway()">
                        üéÅ Create Giveaway
                    </button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span>üéâ</span>
                        <span class="card-title">Active Giveaways</span>
                    </div>
                    <div id="giveawaysList" class="items-grid">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Quests Tab -->
            <div id="quests" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>üéØ</span>
                        <span class="card-title">Create Quest</span>
                    </div>
                    <p class="card-subtitle">Create milestone-based quests for users</p>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Quest Type</label>
                            <select id="questType">
                                <option value="referral">Referral Quest</option>
                                <option value="task">Task Completion Quest</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Target Count</label>
                            <input type="number" id="questTarget" value="5" placeholder="5">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Reward (GOLD)</label>
                        <input type="number" id="questReward" value="1000" placeholder="1000">
                    </div>
                    
                    <button class="btn" onclick="createQuest()">
                        üéØ Create Quest
                    </button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span>üìú</span>
                        <span class="card-title">Active Quests</span>
                    </div>
                    <div id="questsList" class="items-grid">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Lucky Codes Tab -->
            <div id="luckycodes" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>üçÄ</span>
                        <span class="card-title">Create Lucky Code</span>
                    </div>
                    <p class="card-subtitle">Create redeemable codes with rewards</p>
                    
                    <div class="form-group">
                        <label>Code Title</label>
                        <input type="text" id="luckyCodeTitle" placeholder="Welcome Bonus">
                    </div>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Code</label>
                            <input type="text" id="luckyCode" placeholder="WELCOME2024" style="text-transform: uppercase;">
                        </div>
                        <div class="form-group">
                            <label>Reward Amount</label>
                            <input type="number" id="luckyCodeReward" value="500" placeholder="500">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Reward Type</label>
                        <select id="luckyCodeType">
                            <option value="gold">üí∞ GOLD</option>
                            <option value="key">üîë KEY</option>
                            <option value="gem">üíé GEM</option>
                            <option value="card">üé¥ CARD</option>
                        </select>
                    </div>
                    
                    <button class="btn" onclick="createLuckyCode()">
                        üçÄ Create Lucky Code
                    </button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span>üìù</span>
                        <span class="card-title">Existing Codes</span>
                    </div>
                    <div id="luckyCodesList" class="items-grid">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Treasure/Gifts Tab -->
            <div id="gifts" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>üéÅ</span>
                        <span class="card-title">Treasure Rewards</span>
                    </div>
                    <p class="card-subtitle">Configure possible rewards when users open treasure chests</p>
                    
                    <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                        <input type="number" id="newGiftReward" placeholder="Reward amount" style="flex: 1;">
                        <button class="btn btn-small" onclick="addGiftReward()">‚ûï Add</button>
                    </div>
                    
                    <div id="giftRewardsList" class="tags"></div>
                    
                    <div class="divider"></div>
                    
                    <button class="btn" onclick="saveGiftSettings()">
                        üíæ Save Treasure Settings
                    </button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span>‚ÑπÔ∏è</span>
                        <span class="card-title">How It Works</span>
                    </div>
                    <ul style="color: var(--text-muted); font-size: 14px; line-height: 2; list-style: none;">
                        <li>üîë Users collect keys from lucky codes</li>
                        <li>üì¶ 1 key = 1 treasure chest opening</li>
                        <li>üé≤ Random reward from the list above</li>
                        <li>‚öôÔ∏è Add or remove rewards as needed</li>
                    </ul>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
                <!-- Currency Settings -->
                <div class="card">
                    <div class="card-header">
                        <span>üí∞</span>
                        <span class="card-title">Currency & Rates</span>
                    </div>
                    <p class="card-subtitle">Configure conversion rates and rewards</p>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>GOLD per TON</label>
                            <input type="number" id="goldPerTon" placeholder="100000">
                            <p class="help-text">How much GOLD = 1 TON</p>
                        </div>
                        <div class="form-group">
                            <label>TON per GOLD</label>
                            <input type="number" step="0.0000001" id="goldToTonRate" placeholder="0.00001">
                            <p class="help-text">1 GOLD = X TON</p>
                        </div>
                        <div class="form-group">
                            <label>Min Withdrawal (GOLD)</label>
                            <input type="number" id="minWithdrawal" placeholder="10000">
                        </div>
                        <div class="form-group">
                            <label>Referral Commission (%)</label>
                            <input type="number" id="referralPercentage" placeholder="10">
                        </div>
                    </div>
                </div>

                <!-- Daily Rewards -->
                <div class="card">
                    <div class="card-header">
                        <span>üìÖ</span>
                        <span class="card-title">Daily Rewards & Ads</span>
                    </div>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Daily Check-in Reward (GOLD)</label>
                            <input type="number" id="dailyCheckReward" placeholder="100">
                        </div>
                        <div class="form-group">
                            <label>Ad Reward (GOLD)</label>
                            <input type="number" id="adReward" placeholder="50">
                        </div>
                        <div class="form-group">
                            <label>Daily Ad Limit</label>
                            <input type="number" id="dailyAdLimit" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>Gem Withdrawal Fee</label>
                            <input type="number" id="gemFee" placeholder="5">
                            <p class="help-text">Gems required to withdraw</p>
                        </div>
                    </div>
                </div>

                <!-- Task Settings -->
                <div class="card">
                    <div class="card-header">
                        <span>üìã</span>
                        <span class="card-title">Task Settings</span>
                    </div>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Task Payment Address (TON)</label>
                            <input type="text" id="taskPaymentAddress" placeholder="UQ...">
                        </div>
                        <div class="form-group">
                            <label>Impression Price (TON/100)</label>
                            <input type="number" step="0.01" id="impressionPrice" placeholder="0.05">
                        </div>
                    </div>
                </div>

                <!-- Theme Colors -->
                <div class="card">
                    <div class="card-header">
                        <span>üé®</span>
                        <span class="card-title">Theme Colors</span>
                    </div>
                    <p class="card-subtitle">HSL format (e.g., 200 100% 50%)</p>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>Background</label>
                            <input type="text" id="themeBackground" placeholder="200 70% 8%">
                        </div>
                        <div class="form-group">
                            <label>Primary</label>
                            <input type="text" id="themePrimary" placeholder="190 100% 50%">
                        </div>
                        <div class="form-group">
                            <label>Gold/Accent</label>
                            <input type="text" id="themeGold" placeholder="45 93% 58%">
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="saveSettings()">
                    üíæ Save All Settings
                </button>
            </div>

            <!-- Bot Config Tab -->
            <div id="bot" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>ü§ñ</span>
                        <span class="card-title">Telegram Bot Configuration</span>
                    </div>
                    <p class="card-subtitle">Configure bot settings for notifications</p>
                    
                    <div class="form-group">
                        <label>Bot API Token</label>
                        <input type="text" id="botApiToken" placeholder="1234567890:ABC...">
                        <p class="help-text">Get from @BotFather</p>
                    </div>
                    
                    <div class="form-group">
                        <label>Daily Check-in Channel</label>
                        <input type="url" id="dailyCheckChannel" placeholder="https://t.me/yourchannel">
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div class="section-title">üîó TON Connect Manifest</div>
                    
                    <div class="grid">
                        <div class="form-group">
                            <label>App Name</label>
                            <input type="text" id="manifestName" placeholder="MoneyShark">
                        </div>
                        <div class="form-group">
                            <label>App URL</label>
                            <input type="url" id="manifestUrl" placeholder="https://moneyshark.app">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Icon URL</label>
                        <input type="url" id="manifestIconUrl" placeholder="https://moneyshark.app/icon.png">
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div class="switch-container">
                        <label class="switch">
                            <input type="checkbox" id="allowTestnet">
                            <span class="switch-slider"></span>
                        </label>
                        <span>Allow Testnet (for testing)</span>
                    </div>
                    
                    <div class="divider"></div>
                    
                    <button class="btn" onclick="saveBotConfig()">
                        üíæ Save Bot Configuration
                    </button>
                </div>

                <!-- Send Message Card -->
                <div class="card">
                    <div class="card-header">
                        <span>üì®</span>
                        <span class="card-title">Send Message to Users</span>
                    </div>
                    <p class="card-subtitle">Send broadcast message to all or specific users</p>
                    
                    <div class="form-group">
                        <label>Recipient (leave empty for all users)</label>
                        <input type="text" id="msgRecipient" placeholder="Chat ID or leave empty">
                    </div>
                    
                    <div class="form-group">
                        <label>Message</label>
                        <textarea id="msgText" rows="4" placeholder="Enter your message..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Image URL (optional)</label>
                        <input type="url" id="msgImage" placeholder="https://example.com/image.jpg">
                    </div>
                    
                    <button class="btn" onclick="sendBroadcast()">
                        üì® Send Message
                    </button>
                </div>
            </div>

            <!-- Admins Tab -->
            <div id="admins" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <span>üëë</span>
                        <span class="card-title">Admin Management</span>
                    </div>
                    <p class="card-subtitle">Manage administrator access</p>
                    
                    <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                        <input type="number" id="newAdminId" placeholder="Telegram ID" style="flex: 1;">
                        <button class="btn btn-small" onclick="addAdmin()">‚ûï Add Admin</button>
                    </div>
                    
                    <div id="adminsList" class="items-grid">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div class="modal-overlay" id="editUserModal">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title">Edit User</span>
                <button class="modal-close" onclick="closeModal('editUserModal')">√ó</button>
            </div>
            <div id="editUserContent"></div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
        import { getDatabase, ref, onValue, push, set, remove, get, update, query, orderByChild, limitToLast } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js';

        // Firebase configuration - MoneyShark
        const firebaseConfig = {
  apiKey: "AIzaSyBahN_c7w0tRLPg6YdRr4g_uw2R_e7wV2Q",
  authDomain: "robtherichbot.firebaseapp.com",
  databaseURL: "https://robtherichbot-default-rtdb.firebaseio.com",
  projectId: "robtherichbot",
  storageBucket: "robtherichbot.firebasestorage.app",
  messagingSenderId: "296515234410",
  appId: "1:296515234410:web:4adee6c62886cf5526b813"
};

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        // Global references
        window.db = db;
        window.auth = auth;
        window.firebaseRef = ref;
        window.firebaseSet = set;
        window.firebasePush = push;
        window.firebaseRemove = remove;
        window.firebaseGet = get;
        window.firebaseUpdate = update;
        window.firebaseOnValue = onValue;

        // Data stores
        let allWithdrawals = [];
        let allUsers = [];
        let giftRewards = [100, 200, 500, 1000, 2000, 5000];
        let currentAdminList = [];

        // Auth state
        onAuthStateChanged(auth, (user) => {
            if (user && user.email === 'abcoinseo@gmail.com') {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('dashboard').classList.remove('hidden');
                loadAllData();
            } else {
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('dashboard').classList.add('hidden');
            }
        });

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const btn = document.getElementById('loginBtn');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner" style="width:20px;height:20px;margin:0;"></span> Logging in...';
            
            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                if (userCredential.user.email !== 'abcoinseo@gmail.com') {
                    await signOut(auth);
                    showToast('Unauthorized access', 'error');
                } else {
                    showToast('Welcome back, Admin!', 'success');
                }
            } catch (error) {
                let msg = 'Invalid credentials';
                if (error.code === 'auth/user-not-found') msg = 'No account found';
                else if (error.code === 'auth/wrong-password') msg = 'Incorrect password';
                else if (error.code === 'auth/too-many-requests') msg = 'Too many attempts';
                showToast(msg, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<span>üöÄ</span> Login to Dashboard';
            }
        });

        // Logout
        window.logout = async () => {
            await signOut(auth);
            showToast('Logged out successfully', 'info');
        };

        // Load all data
        function loadAllData() {
            loadWithdrawals();
            loadTasks();
            loadUsers();
            loadGiveaways();
            loadQuests();
            loadLuckyCodes();
            loadGiftSettings();
            loadSettings();
            loadAdmins();
            loadStats();
        }

        // Stats
        function loadStats() {
            // Users count
            onValue(ref(db, 'users'), (snapshot) => {
                const count = snapshot.exists() ? Object.keys(snapshot.val()).length : 0;
                document.getElementById('statUsers').textContent = formatNumber(count);
            });

            // Tasks count
            onValue(ref(db, 'tasks'), (snapshot) => {
                if (snapshot.exists()) {
                    const tasks = Object.values(snapshot.val()).filter(t => t.active !== false);
                    document.getElementById('statTasks').textContent = tasks.length;
                } else {
                    document.getElementById('statTasks').textContent = '0';
                }
            });

            // Pending withdrawals
            onValue(ref(db, 'withdrawals'), (snapshot) => {
                if (snapshot.exists()) {
                    const pending = Object.values(snapshot.val()).filter(w => w.status === 'pending');
                    document.getElementById('statWithdrawals').textContent = pending.length;
                } else {
                    document.getElementById('statWithdrawals').textContent = '0';
                }
            });

            // Total gold
            onValue(ref(db, 'users'), (snapshot) => {
                if (snapshot.exists()) {
                    let total = 0;
                    Object.values(snapshot.val()).forEach(u => total += (u.goldBalance || 0));
                    document.getElementById('statGold').textContent = formatNumber(total);
                }
            });
        }

        // Withdrawals
        function loadWithdrawals() {
            onValue(ref(db, 'withdrawals'), (snapshot) => {
                const container = document.getElementById('withdrawalsList');
                if (!snapshot.exists()) {
                    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üí∏</div><p>No withdrawal requests</p></div>';
                    return;
                }
                
                allWithdrawals = Object.entries(snapshot.val())
                    .map(([id, val]) => ({ id, ...val }))
                    .sort((a, b) => (b.createdAt || 0) - (a.createdAt || 0));
                
                renderWithdrawals(allWithdrawals);
            });
        }

        function renderWithdrawals(withdrawals) {
            const container = document.getElementById('withdrawalsList');
            if (withdrawals.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">üîç</div><p>No results found</p></div>';
                return;
            }

            container.innerHTML = withdrawals.slice(0, 100).map(w => `
                <div class="item">
                    <div class="item-header">
                        <div>
                            <div class="item-title">@${w.username || 'Unknown'}</div>
                            <div class="item-meta">ID: ${w.userId || w.chatId} ‚Ä¢ ${formatDate(w.createdAt)}</div>
                        </div>
                        <span class="badge badge-${w.status}">${w.status}</span>
                    </div>
                    <div class="item-reward">üí∞ ${formatNumber(w.goldAmount)} GOLD ‚Üí ${(w.tonAmount || 0).toFixed(6)} TON</div>
                    <div class="item-meta" style="word-break: break-all;">üìç ${w.tonAddress}</div>
                    ${w.status === 'pending' ? `
                        <div class="btn-group">
                            <button class="btn btn-success btn-small" onclick="approveWithdrawal('${w.id}', ${JSON.stringify(w).replace(/"/g, '&quot;')})">
                                ‚úÖ Approve
                            </button>
                            <button class="btn btn-danger btn-small" onclick="rejectWithdrawal('${w.id}', ${JSON.stringify(w).replace(/"/g, '&quot;')})">
                                ‚ùå Reject
                            </button>
                        </div>
                    ` : w.transactionHash ? `<div class="item-meta">üîó TX: ${w.transactionHash.substring(0, 30)}...</div>` : ''}
                </div>
            `).join('');
        }

        window.filterWithdrawals = () => {
            const search = document.getElementById('searchWithdrawals').value.toLowerCase();
            const filtered = allWithdrawals.filter(w => 
                (w.username || '').toLowerCase().includes(search) ||
                (w.tonAddress || '').toLowerCase().includes(search)
            );
            renderWithdrawals(filtered);
        };

        window.approveWithdrawal = async (id, withdrawal) => {
            const txHash = prompt('Enter transaction hash/link:');
            if (!txHash) return;
            
            try {
                await update(ref(db, `withdrawals/${id}`), {
                    status: 'approved',
                    transactionHash: txHash,
                    processedAt: Date.now()
                });
                
                const settings = await get(ref(db, 'admin/settings'));
                if (settings.exists() && settings.val().botApiToken) {
                    const botToken = settings.val().botApiToken;
                    const message = `‚úÖ Withdrawal Approved!\n\nüí∞ Amount: ${withdrawal.goldAmount} GOLD ‚Üí ${withdrawal.tonAmount.toFixed(6)} TON\nüîó TX: ${txHash}`;
                    
                    await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chat_id: withdrawal.userId || withdrawal.chatId, text: message })
                    });
                }
                
                showToast('Withdrawal approved!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.rejectWithdrawal = async (id, withdrawal) => {
            const reason = prompt('Enter rejection reason:');
            if (!reason) return;
            
            try {
                const userId = withdrawal.userId || withdrawal.chatId;
                const userRef = ref(db, `users/${userId}`);
                const userSnap = await get(userRef);
                
                if (userSnap.exists()) {
                    const balance = userSnap.val().goldBalance || 0;
                    await update(userRef, { goldBalance: balance + withdrawal.goldAmount });
                }
                
                await update(ref(db, `withdrawals/${id}`), {
                    status: 'rejected',
                    rejectReason: reason,
                    processedAt: Date.now()
                });
                
                const settings = await get(ref(db, 'admin/settings'));
                if (settings.exists() && settings.val().botApiToken) {
                    const botToken = settings.val().botApiToken;
                    const message = `‚ùå Withdrawal Rejected\n\nüí∞ ${withdrawal.goldAmount} GOLD refunded\nüìù Reason: ${reason}`;
                    
                    await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chat_id: userId, text: message })
                    });
                }
                
                showToast('Withdrawal rejected & refunded', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Tasks
        window.toggleTaskFields = () => {
            const type = document.getElementById('taskType').value;
            document.getElementById('taskCodeGroup').style.display = type === 'code' ? 'block' : 'none';
        };

        function loadTasks() {
            onValue(ref(db, 'tasks'), (snapshot) => {
                const container = document.getElementById('tasksList');
                if (!snapshot.exists()) {
                    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üìã</div><p>No tasks created</p></div>';
                    return;
                }
                
                const tasks = Object.entries(snapshot.val()).map(([id, val]) => ({ id, ...val }));
                
                container.innerHTML = tasks.map(t => `
                    <div class="item">
                        <div class="item-header">
                            <div>
                                <div class="item-title">${t.title}</div>
                                <div class="item-desc">${t.description || ''}</div>
                                <div class="item-reward">+${formatNumber(t.reward)} GOLD</div>
                                <div class="item-meta">
                                    üìä ${t.completedImpressions || 0}/${t.impressions || '‚àû'} impressions ‚Ä¢ 
                                    ${t.type === 'telegram' ? 'üì± Telegram' : t.type === 'code' ? 'üîë Code' : 'üîó Link'}
                                </div>
                            </div>
                            <div class="btn-group" style="margin:0; flex-direction:column;">
                                <button class="btn btn-secondary btn-icon" onclick="editTask('${t.id}', ${JSON.stringify(t).replace(/"/g, '&quot;')})">‚úèÔ∏è</button>
                                <button class="btn btn-danger btn-icon" onclick="deleteTask('${t.id}')">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            });
        }

        window.createTask = async () => {
            const title = document.getElementById('taskTitle').value.trim();
            const desc = document.getElementById('taskDesc').value.trim();
            const type = document.getElementById('taskType').value;
            const reward = parseInt(document.getElementById('taskReward').value) || 100;
            const link = document.getElementById('taskLink').value.trim();
            const code = document.getElementById('taskCode').value.trim();
            const impressions = parseInt(document.getElementById('taskImpressions').value) || 0;
            
            if (!title || !link) {
                showToast('Please fill required fields', 'error');
                return;
            }
            
            try {
                await push(ref(db, 'tasks'), {
                    title, description: desc, type, reward, link,
                    code: type === 'code' ? code : null,
                    impressions, completedImpressions: 0,
                    createdAt: Date.now(), active: true
                });
                
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskDesc').value = '';
                document.getElementById('taskLink').value = '';
                document.getElementById('taskCode').value = '';
                showToast('Task created!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.editTask = async (id, task) => {
            const newTitle = prompt('Task title:', task.title);
            if (!newTitle) return;
            const newReward = prompt('Reward (GOLD):', task.reward);
            const newImpressions = prompt('Max impressions:', task.impressions || 0);
            
            try {
                await update(ref(db, `tasks/${id}`), {
                    title: newTitle,
                    reward: parseInt(newReward) || task.reward,
                    impressions: parseInt(newImpressions) || 0
                });
                showToast('Task updated!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.deleteTask = async (id) => {
            if (!confirm('Delete this task?')) return;
            try {
                await remove(ref(db, `tasks/${id}`));
                showToast('Task deleted!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Users
        function loadUsers() {
            onValue(ref(db, 'users'), (snapshot) => {
                const container = document.getElementById('usersList');
                if (!snapshot.exists()) {
                    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üë•</div><p>No users found</p></div>';
                    return;
                }
                
                allUsers = Object.entries(snapshot.val())
                    .map(([id, val]) => ({ id, ...val }))
                    .sort((a, b) => (b.goldBalance || 0) - (a.goldBalance || 0));
                
                renderUsers(allUsers.slice(0, 50));
            });
        }

        function renderUsers(users) {
            const container = document.getElementById('usersList');
            if (users.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">üîç</div><p>No users found</p></div>';
                return;
            }

            container.innerHTML = users.map(u => `
                <div class="item">
                    <div class="item-header">
                        <div>
                            <div class="item-title">@${u.username || 'Unknown'}</div>
                            <div class="item-meta">ID: ${u.id}</div>
                            <div class="item-reward">
                                üí∞ ${formatNumber(u.goldBalance || 0)} GOLD ‚Ä¢ 
                                üíé ${u.gemBalance || 0} Gems ‚Ä¢ 
                                üé¥ ${u.cardBalance || 0} Cards
                            </div>
                            <div class="item-meta">
                                üë• ${u.totalReferrals || 0} referrals ‚Ä¢ 
                                ‚úÖ ${(u.completedTasks || []).length} tasks
                            </div>
                        </div>
                        <div class="btn-group" style="margin:0; flex-direction:column;">
                            <button class="btn btn-secondary btn-icon" onclick="editUser('${u.id}')">‚úèÔ∏è</button>
                            <button class="btn btn-warning btn-icon" onclick="resetUser('${u.id}')">üîÑ</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        window.filterUsers = () => {
            const search = document.getElementById('searchUsers').value.toLowerCase();
            const filtered = allUsers.filter(u => 
                (u.username || '').toLowerCase().includes(search) ||
                String(u.id).includes(search)
            );
            renderUsers(filtered.slice(0, 50));
        };

        window.editUser = async (id) => {
            const userSnap = await get(ref(db, `users/${id}`));
            if (!userSnap.exists()) return showToast('User not found', 'error');
            
            const user = userSnap.val();
            const newGold = prompt('Gold Balance:', user.goldBalance || 0);
            if (newGold === null) return;
            
            const newGems = prompt('Gem Balance:', user.gemBalance || 0);
            const newCards = prompt('Card Balance:', user.cardBalance || 0);
            
            try {
                await update(ref(db, `users/${id}`), {
                    goldBalance: parseInt(newGold) || 0,
                    gemBalance: parseInt(newGems) || 0,
                    cardBalance: parseInt(newCards) || 0
                });
                showToast('User updated!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.resetUser = async (id) => {
            if (!confirm('Reset this user\'s completed tasks?')) return;
            try {
                await update(ref(db, `users/${id}`), { completedTasks: [] });
                showToast('User tasks reset!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Giveaways
        function loadGiveaways() {
            onValue(ref(db, 'giveaways'), (snapshot) => {
                const container = document.getElementById('giveawaysList');
                if (!snapshot.exists()) {
                    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üéÅ</div><p>No giveaways</p></div>';
                    return;
                }
                
                const giveaways = Object.entries(snapshot.val()).map(([id, val]) => ({ id, ...val }));
                
                container.innerHTML = giveaways.map(g => {
                    const endDate = new Date(g.endAt);
                    const isEnded = Date.now() > g.endAt;
                    
                    return `
                        <div class="item">
                            <div class="item-header">
                                <div>
                                    <div class="item-title">${g.title}</div>
                                    <div class="item-desc">${g.description || ''}</div>
                                    <div class="item-reward">
                                        ü•á ${formatNumber(g.prize1)} ‚Ä¢ 
                                        ü•à ${formatNumber(g.prize2)} ‚Ä¢ 
                                        ü•â ${formatNumber(g.prize3)} GOLD
                                    </div>
                                    <div class="item-meta">
                                        ${isEnded ? 'üî¥ Ended' : 'üü¢ Active'} ‚Ä¢ 
                                        Ends: ${endDate.toLocaleDateString()}
                                    </div>
                                </div>
                                <span class="badge ${isEnded ? 'badge-rejected' : 'badge-active'}">${isEnded ? 'Ended' : 'Active'}</span>
                            </div>
                            <div class="btn-group">
                                ${!isEnded ? `<button class="btn btn-warning btn-small" onclick="endGiveaway('${g.id}')">üèÜ End & Pick Winners</button>` : ''}
                                <button class="btn btn-danger btn-small" onclick="deleteGiveaway('${g.id}')">üóëÔ∏è Delete</button>
                            </div>
                        </div>
                    `;
                }).join('');
            });
        }

        window.createGiveaway = async () => {
            const title = document.getElementById('giveawayTitle').value.trim();
            const desc = document.getElementById('giveawayDesc').value.trim();
            const prize1 = parseInt(document.getElementById('prize1').value) || 10000;
            const prize2 = parseInt(document.getElementById('prize2').value) || 5000;
            const prize3 = parseInt(document.getElementById('prize3').value) || 2500;
            const days = parseInt(document.getElementById('giveawayDays').value) || 7;
            
            if (!title) {
                showToast('Please enter a title', 'error');
                return;
            }
            
            try {
                await push(ref(db, 'giveaways'), {
                    title, description: desc,
                    prize1, prize2, prize3,
                    createdAt: Date.now(),
                    endAt: Date.now() + (days * 24 * 60 * 60 * 1000)
                });
                
                document.getElementById('giveawayTitle').value = '';
                document.getElementById('giveawayDesc').value = '';
                showToast('Giveaway created!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.endGiveaway = async (id) => {
            if (!confirm('End this giveaway and pick winners based on card balance?')) return;
            
            try {
                const giveawaySnap = await get(ref(db, `giveaways/${id}`));
                if (!giveawaySnap.exists()) return showToast('Giveaway not found', 'error');
                
                const giveaway = giveawaySnap.val();
                const usersSnap = await get(ref(db, 'users'));
                
                if (!usersSnap.exists()) return showToast('No users found', 'error');
                
                const users = Object.entries(usersSnap.val())
                    .map(([uid, data]) => ({ id: uid, ...data }))
                    .filter(u => (u.cardBalance || 0) > 0)
                    .sort((a, b) => (b.cardBalance || 0) - (a.cardBalance || 0));
                
                if (users.length < 3) return showToast('Not enough participants', 'error');
                
                const winners = [
                    { user: users[0], prize: giveaway.prize1, place: 1 },
                    { user: users[1], prize: giveaway.prize2, place: 2 },
                    { user: users[2], prize: giveaway.prize3, place: 3 }
                ];
                
                // Award prizes
                for (const winner of winners) {
                    await update(ref(db, `users/${winner.user.id}`), {
                        goldBalance: (winner.user.goldBalance || 0) + winner.prize
                    });
                }
                
                // Save winners
                await update(ref(db, `giveaways/${id}`), {
                    ended: true,
                    endAt: Date.now(),
                    winners: winners.map(w => ({
                        id: w.user.id,
                        username: w.user.username,
                        prize: w.prize,
                        place: w.place
                    }))
                });
                
                showToast(`Winners: ü•á${winners[0].user.username} ü•à${winners[1].user.username} ü•â${winners[2].user.username}`, 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.deleteGiveaway = async (id) => {
            if (!confirm('Delete this giveaway?')) return;
            try {
                await remove(ref(db, `giveaways/${id}`));
                showToast('Giveaway deleted!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Quests
        function loadQuests() {
            onValue(ref(db, 'quests'), (snapshot) => {
                const container = document.getElementById('questsList');
                if (!snapshot.exists()) {
                    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üéØ</div><p>No quests</p></div>';
                    return;
                }
                
                const quests = Object.entries(snapshot.val()).map(([id, val]) => ({ id, ...val }));
                
                container.innerHTML = quests.map(q => `
                    <div class="item">
                        <div class="item-header">
                            <div>
                                <div class="item-title">${q.type === 'referral' ? 'üë• Referral Quest' : 'üìã Task Quest'}</div>
                                <div class="item-desc">Reach ${q.target} ${q.type === 'referral' ? 'referrals' : 'tasks'}</div>
                                <div class="item-reward">+${formatNumber(q.reward)} GOLD</div>
                            </div>
                            <button class="btn btn-danger btn-icon" onclick="deleteQuest('${q.id}')">üóëÔ∏è</button>
                        </div>
                    </div>
                `).join('');
            });
        }

        window.createQuest = async () => {
            const type = document.getElementById('questType').value;
            const target = parseInt(document.getElementById('questTarget').value) || 5;
            const reward = parseInt(document.getElementById('questReward').value) || 1000;
            
            try {
                await push(ref(db, 'quests'), { type, target, reward, createdAt: Date.now() });
                showToast('Quest created!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.deleteQuest = async (id) => {
            if (!confirm('Delete this quest?')) return;
            try {
                await remove(ref(db, `quests/${id}`));
                showToast('Quest deleted!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Lucky Codes
        function loadLuckyCodes() {
            onValue(ref(db, 'luckyCodes'), (snapshot) => {
                const container = document.getElementById('luckyCodesList');
                if (!snapshot.exists()) {
                    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üçÄ</div><p>No lucky codes</p></div>';
                    return;
                }
                
                const codes = Object.entries(snapshot.val()).map(([id, val]) => ({ id, ...val }));
                
                container.innerHTML = codes.map(c => `
                    <div class="item">
                        <div class="item-header">
                            <div>
                                <div class="item-title">${c.title}</div>
                                <div class="item-meta">Code: <strong style="color:var(--primary);">${c.code}</strong></div>
                                <div class="item-reward">+${c.reward} ${c.rewardType === 'key' ? 'üîë KEY' : c.rewardType === 'gem' ? 'üíé GEM' : c.rewardType === 'card' ? 'üé¥ CARD' : 'üí∞ GOLD'}</div>
                                <div class="item-meta">Used by ${(c.usedBy || []).length} users</div>
                            </div>
                            <button class="btn btn-danger btn-icon" onclick="deleteLuckyCode('${c.code}')">üóëÔ∏è</button>
                        </div>
                    </div>
                `).join('');
            });
        }

        window.createLuckyCode = async () => {
            const title = document.getElementById('luckyCodeTitle').value.trim();
            const code = document.getElementById('luckyCode').value.toUpperCase().trim();
            const reward = parseInt(document.getElementById('luckyCodeReward').value) || 500;
            const rewardType = document.getElementById('luckyCodeType').value;
            
            if (!title || !code) {
                showToast('Please fill all fields', 'error');
                return;
            }
            
            try {
                await set(ref(db, `luckyCodes/${code}`), {
                    title, code, reward, rewardType,
                    createdAt: Date.now(), usedBy: []
                });
                
                document.getElementById('luckyCodeTitle').value = '';
                document.getElementById('luckyCode').value = '';
                showToast('Lucky code created!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.deleteLuckyCode = async (code) => {
            if (!confirm('Delete this lucky code?')) return;
            try {
                await remove(ref(db, `luckyCodes/${code}`));
                showToast('Lucky code deleted!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Gift/Treasure Settings
        function loadGiftSettings() {
            get(ref(db, 'admin/giftSettings')).then((snapshot) => {
                if (snapshot.exists()) {
                    giftRewards = snapshot.val().rewards || [100, 200, 500, 1000, 2000, 5000];
                }
                renderGiftRewards();
            });
        }

        function renderGiftRewards() {
            const container = document.getElementById('giftRewardsList');
            container.innerHTML = giftRewards.map((reward, index) => `
                <div class="tag">
                    <span>üí∞ ${formatNumber(reward)} GOLD</span>
                    <span class="tag-remove" onclick="removeGiftReward(${index})">√ó</span>
                </div>
            `).join('');
        }

        window.addGiftReward = () => {
            const input = document.getElementById('newGiftReward');
            const amount = parseInt(input.value);
            
            if (isNaN(amount) || amount <= 0) {
                showToast('Invalid amount', 'error');
                return;
            }
            
            giftRewards.push(amount);
            giftRewards.sort((a, b) => a - b);
            input.value = '';
            renderGiftRewards();
        };

        window.removeGiftReward = (index) => {
            giftRewards.splice(index, 1);
            renderGiftRewards();
        };

        window.saveGiftSettings = async () => {
            try {
                await set(ref(db, 'admin/giftSettings'), { rewards: giftRewards });
                showToast('Treasure settings saved!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Settings
        function loadSettings() {
            get(ref(db, 'admin/settings')).then((snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    document.getElementById('minWithdrawal').value = data.minWithdrawal || 10000;
                    document.getElementById('goldToTonRate').value = data.goldToTonRate || 0.00001;
                    document.getElementById('goldPerTon').value = data.goldPerTon || 100000;
                    document.getElementById('referralPercentage').value = data.referralPercentage || 10;
                    document.getElementById('taskPaymentAddress').value = data.taskPaymentAddress || '';
                    document.getElementById('botApiToken').value = data.botApiToken || '';
                    document.getElementById('adReward').value = data.adReward || 50;
                    document.getElementById('dailyAdLimit').value = data.dailyAdLimit || 10;
                    document.getElementById('dailyCheckReward').value = data.dailyCheckReward || 100;
                    document.getElementById('dailyCheckChannel').value = data.dailyCheckChannel || '';
                    document.getElementById('impressionPrice').value = data.impressionPrice || 0.05;
                    document.getElementById('gemFee').value = data.gemFee || 5;
                    document.getElementById('manifestName').value = data.manifestName || 'MoneyShark';
                    document.getElementById('manifestUrl').value = data.manifestUrl || '';
                    document.getElementById('manifestIconUrl').value = data.manifestIconUrl || '';
                    document.getElementById('themeBackground').value = data.themeColors?.background || '200 70% 8%';
                    document.getElementById('themePrimary').value = data.themeColors?.primary || '190 100% 50%';
                    document.getElementById('themeGold').value = data.themeColors?.gold || '45 93% 58%';
                    document.getElementById('allowTestnet').checked = data.allowTestnet || false;
                    currentAdminList = data.adminList || [8101021767, 7323645947];
                }
            });
        }

        window.saveSettings = async () => {
            try {
                const currentSettings = (await get(ref(db, 'admin/settings'))).val() || {};
                
                await set(ref(db, 'admin/settings'), {
                    ...currentSettings,
                    minWithdrawal: parseInt(document.getElementById('minWithdrawal').value) || 10000,
                    goldToTonRate: parseFloat(document.getElementById('goldToTonRate').value) || 0.00001,
                    goldPerTon: parseInt(document.getElementById('goldPerTon').value) || 100000,
                    referralPercentage: parseInt(document.getElementById('referralPercentage').value) || 10,
                    taskPaymentAddress: document.getElementById('taskPaymentAddress').value,
                    adReward: parseInt(document.getElementById('adReward').value) || 50,
                    dailyAdLimit: parseInt(document.getElementById('dailyAdLimit').value) || 10,
                    dailyCheckReward: parseInt(document.getElementById('dailyCheckReward').value) || 100,
                    impressionPrice: parseFloat(document.getElementById('impressionPrice').value) || 0.05,
                    gemFee: parseInt(document.getElementById('gemFee').value) || 5,
                    themeColors: {
                        background: document.getElementById('themeBackground').value,
                        primary: document.getElementById('themePrimary').value,
                        gold: document.getElementById('themeGold').value
                    }
                });
                showToast('Settings saved!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.saveBotConfig = async () => {
            try {
                const currentSettings = (await get(ref(db, 'admin/settings'))).val() || {};
                
                await set(ref(db, 'admin/settings'), {
                    ...currentSettings,
                    botApiToken: document.getElementById('botApiToken').value,
                    dailyCheckChannel: document.getElementById('dailyCheckChannel').value,
                    manifestName: document.getElementById('manifestName').value,
                    manifestUrl: document.getElementById('manifestUrl').value,
                    manifestIconUrl: document.getElementById('manifestIconUrl').value,
                    allowTestnet: document.getElementById('allowTestnet').checked
                });
                showToast('Bot configuration saved!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Broadcast Message
        window.sendBroadcast = async () => {
            const recipient = document.getElementById('msgRecipient').value.trim();
            const text = document.getElementById('msgText').value.trim();
            const image = document.getElementById('msgImage').value.trim();
            
            if (!text) return showToast('Please enter a message', 'error');
            
            const settings = await get(ref(db, 'admin/settings'));
            if (!settings.exists() || !settings.val().botApiToken) {
                return showToast('Bot token not configured', 'error');
            }
            
            const botToken = settings.val().botApiToken;
            
            try {
                if (recipient) {
                    // Single user
                    if (image) {
                        await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ chat_id: recipient, photo: image, caption: text })
                        });
                    } else {
                        await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ chat_id: recipient, text: text })
                        });
                    }
                    showToast('Message sent!', 'success');
                } else {
                    // Broadcast to all
                    const usersSnap = await get(ref(db, 'users'));
                    if (!usersSnap.exists()) return showToast('No users found', 'error');
                    
                    const users = Object.keys(usersSnap.val());
                    let sent = 0;
                    
                    for (const chatId of users) {
                        try {
                            if (image) {
                                await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ chat_id: chatId, photo: image, caption: text })
                                });
                            } else {
                                await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ chat_id: chatId, text: text })
                                });
                            }
                            sent++;
                        } catch (e) { /* Skip failed */ }
                        await new Promise(r => setTimeout(r, 50)); // Rate limit
                    }
                    
                    showToast(`Broadcast sent to ${sent}/${users.length} users`, 'success');
                }
                
                document.getElementById('msgText').value = '';
                document.getElementById('msgImage').value = '';
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Admins
        function loadAdmins() {
            get(ref(db, 'admin/settings/adminList')).then((snapshot) => {
                const container = document.getElementById('adminsList');
                currentAdminList = snapshot.exists() ? snapshot.val() : [8101021767, 7323645947];
                
                container.innerHTML = currentAdminList.map(id => `
                    <div class="item">
                        <div class="item-header">
                            <div>
                                <div class="item-title">Admin ID: ${id}</div>
                                ${(id === 8101021767 || id === 7323645947) ? '<div class="item-meta">üëë Super Admin</div>' : ''}
                            </div>
                            ${(id !== 8101021767 && id !== 7323645947) ? `
                                <button class="btn btn-danger btn-icon" onclick="removeAdmin(${id})">üóëÔ∏è</button>
                            ` : ''}
                        </div>
                    </div>
                `).join('');
            });
        }

        window.addAdmin = async () => {
            const id = parseInt(document.getElementById('newAdminId').value);
            if (!id || id <= 0) return showToast('Invalid Telegram ID', 'error');
            if (currentAdminList.includes(id)) return showToast('Admin already exists', 'error');
            
            try {
                const newList = [...currentAdminList, id];
                await set(ref(db, 'admin/settings/adminList'), newList);
                currentAdminList = newList;
                document.getElementById('newAdminId').value = '';
                loadAdmins();
                showToast('Admin added!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        window.removeAdmin = async (id) => {
            if (!confirm('Remove this admin?')) return;
            try {
                const newList = currentAdminList.filter(a => a !== id);
                await set(ref(db, 'admin/settings/adminList'), newList);
                currentAdminList = newList;
                loadAdmins();
                showToast('Admin removed!', 'success');
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            }
        };

        // Tab switching
        window.switchTab = (tab) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
        };

        // Modal
        window.closeModal = (id) => {
            document.getElementById(id).classList.remove('active');
        };

        // Toast notifications
        window.showToast = (message, type = 'info') => {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `<span>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span> ${message}`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        };

        // Utilities
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function formatDate(timestamp) {
            if (!timestamp) return 'Unknown';
            return new Date(timestamp).toLocaleDateString('en-US', {
                month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit'
            });
        }
    </script>
</body>
</html>
